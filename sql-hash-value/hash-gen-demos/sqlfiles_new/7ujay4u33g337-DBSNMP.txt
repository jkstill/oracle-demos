SELECT BLDS.BSLN_GUID ,BLDS.METRIC_ID ,:B4 ,BLDS.TIMEGROUP ,BLDS.DBID ,BLDS.INSTANCE_NAME ,TP.THRESHOLD_METHOD ,TP.NUM_OCCURRENCES ,TP.WARNING_PARAM ,TP.CRITICAL_PARAM ,TP.FAIL_ACTION ,ST.SAMPLE_COUNT ,ROUND(ST.MINIMUM,3) AS MINIMUM ,ROUND(ST.MAXIMUM,3) AS MAXIMUM ,ROUND(ST.PCTILE_95,3) AS PCTILE_95 ,ROUND(ST.PCTILE_99,3) AS PCTILE_99 ,ROUND(ST.EST_PCTILE_999,3) AS PCTILE_999 ,ROUND(ST.EST_PCTILE_9999,3) AS PCTILE_9999 ,EST_FIT_QUALITY ,EST_SAMPLE_COUNT FROM BSLN_THRESHOLD_PARAMS TP ,BSLN_STATISTICS ST ,(SELECT B.BSLN_GUID AS BSLN_GUID ,B.DBID AS DBID ,B.INSTANCE_NAME AS INSTANCE_NAME ,B.TIMEGROUPING AS TIMEGROUPING ,BSLN.TIMEGROUP(B.TIMEGROUPING,:B4 ) AS TIMEGROUP ,D.METRIC_ID AS METRIC_ID FROM BSLN_BASELINES B ,BSLN_METRIC_DEFAULTS D WHERE B.STATUS = DECODE(:B2 , NULL, :B3 , B.STATUS) AND B.BSLN_GUID = NVL(:B2 ,B.BSLN_GUID) AND B.TIMEGROUPING IS NOT NULL AND D.METRIC_ID = NVL(:B1 ,D.METRIC_ID) ) BLDS WHERE BLDS.BSLN_GUID = TP.BSLN_GUID AND BLDS.METRIC_ID = TP.METRIC_ID AND BLDS.BSLN_GUID = ST.BSLN_GUID(+) AND BLDS.METRIC_ID = ST.METRIC_ID(+) AND BLDS.TIMEGROUP = ST.TIMEGROUP(+)